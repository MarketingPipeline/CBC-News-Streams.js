/**!
 * @license CBC-News-Streams.js - A JavaScript library for fetching free live TV stream URLs from CBC.ca / CBC News
 * VERSION: 1.0.0
 * CREATED BY: JARED VAN VALKENOGED
 * LICENSED UNDER MIT LICENSE
 * MORE INFO CAN BE FOUND AT https://github.com/MarketingPipeline/CBC-News-Streams.js/
 */ export function CBC_News_Streams(){if("undefined"!=typeof node||"object"==typeof process)try{require("node-fetch")}catch(t){console.log('node-fetch is not installed. Please install node-fetch to use "CBC-News.js".'),"undefined"!=typeof process&&process.exit(1)}async function e(){try{return await a(await r("url","https://tpfeed.cbc.ca/f/ExhSPC/t_t3UKJR6MAT?pretty=true&sort=pubDate%7Cdesc"))}catch(t){throw t}}async function n(t){try{if(!t)throw Error("Error: No channel title provided to .getChannel() for.");t=t.charAt(0).toUpperCase()+t.slice(1);let e=(await r("url","https://tpfeed.cbc.ca/f/ExhSPC/t_t3UKJR6MAT?pretty=true&sort=pubDate%7Cdesc")).entries,n=!1;for(let a in e)if(t===e[a].title){n=!0;return{channel_title:e[a].title,description:e[a].description,channel_image:e[a].cbc$staticImage,stream_url:await c(e[a].content[0].url)}}if(!0!=n)throw Error(`Error: No results found for channel ${t}`)}catch(i){throw i}}async function r(t,e){if("text"===t){let n=await fetch(e),r=await n.text();return r}{let a=await fetch(e),c=await a.json();return c}}async function a(t){let e=[];for(let n in t)for(let r in t[n])t[n][r].id&&e.push({channel_title:t[n][r].title,description:t[n][r].description,channel_image:t[n][r].cbc$staticImage,stream_url:await c(t[n][r].content[0].url)});return e}async function c(t){try{let e=await r("text",t);return function t(e){let n,r=(n=new DOMParser().parseFromString(e,"text/xml")).querySelector("video").outerHTML,a=r.match(/src="[^"]*"/gm),c=a[0].replace('src="',"");return c=c.replace('"',"")}(e)}catch(n){throw n}}return{getChannel:n,getAllChannels:e}}
